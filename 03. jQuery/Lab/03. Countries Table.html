<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Countries Table</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>
    <style>
        td, th {
            background: #DDD;
            padding: 5px 10px
        }

        input[type='text'] {
            width: 60px
        }

        a {
            margin-left: 5px
        }
    </style>
</head>
<body>
<table id="countriesTable">
    <tr>
        <th>Country</th>
        <th>Capital</th>
        <th>Action</th>
    </tr>
    <tr>
        <td><input type="text" id="newCountryText"/></td>
        <td><input type="text" id="newCapitalText"/></td>
        <td><a href="#" id="createLink">[Create]</a></td>
    </tr>
</table>
<script>
  $(() => initializeTable());

  function initializeTable() {
    $('#createLink').on('click', createCountry);
    addCountryToTable('Bulgaria', 'Sofia');
    addCountryToTable('Germany', 'Berlin');
    addCountryToTable('Russia', 'Moscow');
    fixRowLinks();

    function createCountry() {
      const $newCountryText = $('#newCountryText');
      const $newCapitalText = $('#newCapitalText');
      const country = $newCountryText.val();
      const capital = $newCapitalText.val();
      addCountryToTable(country, capital);
      $newCountryText.val('');
      $newCapitalText.val('');
      fixRowLinks();
    }

    function addCountryToTable(country, capital) {
      const row = $('<tr>')
        .append($('<td>').text(country))
        .append($('<td>').text(capital))
        .append($('<td>')
          .append($('<a href=\'#\'>[Up]</a>').on('click', moveRowUp))
          .append($('<a href=\'#\'>[Down]</a>').on('click', moveRowDown))
          .append($('<a href=\'#\'>[Delete]</a>').on('click', deleteRow)));
      row.css('display', 'none');
      $('#countriesTable').append(row);
      row.fadeIn();
    }

    function moveRowUp() {
      const row = $(this).parent().parent();
      row.fadeOut(function () {
        row.insertBefore(row.prev());
        row.fadeIn();
        fixRowLinks();
      });
    }

    function moveRowDown() {
      let row = $(this).parent().parent();
      row.fadeOut(function () {
        row.insertAfter(row.next());
        row.fadeIn();
        fixRowLinks();
      });
    }

    function deleteRow() {
      let row = $(this).parent().parent();
      row.fadeOut(function () {
        row.remove();
        fixRowLinks();
      });
    }

    function fixRowLinks() {
      // Show all links in the table
      $('#countriesTable a').css('display', 'inline');
      // Hide [Up] link in first table data row
      const tableRows = $('#countriesTable tr');
      $(tableRows[2]).find('a:contains(\'Up\')').css('display', 'none');
      // Hide the [Down] link in the last table row
      $(tableRows[tableRows.length - 1]).find('a:contains(\'Down\')').css('display', 'none');
    }
  }
</script>
</body>
</html>
